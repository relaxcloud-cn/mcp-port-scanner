# 🎯 Cursor MCP端口扫描使用指南

## 🚀 快速开始

### 1. 确认MCP配置
确保您的 `%APPDATA%\Cursor\mcp_settings.json` 包含：
```json
{
  "mcpServers": {
    "port-scanner": {
      "command": "docker",
      "args": [
        "exec", "-i", "mcp-port-scanner", 
        "python", "-m", "mcp_port_scanner.mcp_server"
      ],
      "cwd": "D:\\ProjectCode\\mcp-port-scanner"
    }
  }
}
```

### 2. 重启Cursor
配置完成后重启Cursor，AI将自动识别MCP工具。

## 💬 使用模板

### 🎯 单目标深度扫描
```
请扫描目标 8.8.8.8，进行全面的安全分析
```
**AI会自动**：
- 使用 `scan_target` 工具
- 选择深度扫描层级
- 分析端口、Web服务和安全风险
- 提供修复建议

### 📊 批量网络扫描
```
批量扫描以下目标，重点关注Web服务：
- 192.168.1.1
- 192.168.1.100
- www.example.com
```
**AI会自动**：
- 使用 `batch_scan` 工具
- 选择标准扫描模式
- 控制并发数为3
- 生成资产清单

### ⚡ 快速应急扫描
```
紧急扫描 192.168.1.50，怀疑有异常服务
```
**AI会自动**：
- 使用 `scan_target` 工具
- 选择快速扫描模式
- 优先报告高风险发现
- 提供即时防护建议

### 📈 进度跟踪
```
查看当前所有扫描任务的状态
```
**AI会自动**：
- 使用 `list_active_scans` 工具
- 显示所有活跃任务
- 对完成的扫描获取结果

### 🔍 结果分析
```
分析扫描ID为 abc123 的详细结果
```
**AI会自动**：
- 使用 `get_scan_result` 工具
- 进行深度安全分析
- 生成风险报告

## 🎨 高级用法

### 自定义扫描配置
```
扫描 192.168.1.200，仅检查以下端口：22, 80, 443, 8080
超时设置为2秒，启用管理界面扫描
```

### 网络段扫描
```
扫描整个C段 192.168.1.0/24，找出所有Web服务器
控制并发数为5，使用标准扫描模式
```

### 定制化分析
```
对比扫描 target1.com 和 target2.com 的安全状况
重点分析：
1. 开放端口差异
2. Web技术栈对比  
3. 安全配置评估
4. 风险等级对比
```

## 📋 最佳实践

### ✅ 推荐做法

1. **明确扫描目的**
   ```
   为了安全审计，请扫描我们的Web服务器 192.168.10.100
   ```

2. **指定扫描深度**
   ```
   快速扫描这些主机，只需要端口信息：[IP列表]
   ```

3. **关注特定服务**
   ```
   扫描 target.com，重点关注Web服务和数据库端口
   ```

4. **要求具体分析**
   ```
   分析上次扫描结果，提供优先级修复建议
   ```

### ❌ 避免的做法

1. **过于模糊的请求**
   ```
   ❌ "扫描一下网络"
   ✅ "扫描192.168.1.0/24网段，发现Web服务"
   ```

2. **未指定授权范围**
   ```
   ❌ "扫描互联网上的服务器"
   ✅ "扫描我们内部的测试环境"
   ```

## 🔧 故障排除

### MCP工具不可用
```
检查MCP服务器状态，如果未启动请启动Docker容器
```

### 扫描超时或失败
```
查看当前扫描状态，必要时重新启动扫描
```

### 结果不完整
```
获取扫描ID为 [scan_id] 的完整结果
```

## 🎯 使用场景示例

### 安全审计
```
作为月度安全审计，请扫描以下生产环境资产：
- web-server-01: 10.0.1.100
- db-server-01: 10.0.2.50  
- api-gateway: 10.0.3.200

生成安全审计报告，包括：
1. 资产清单
2. 开放服务列表
3. 安全风险评估
4. 修复优先级建议
```

### 事件响应
```
接到告警，怀疑 192.168.50.100 被入侵
请立即扫描该主机：
1. 识别所有开放端口
2. 检查异常服务
3. 分析潜在后门
4. 提供即时隔离建议
```

### 合规检查
```
为了PCI DSS合规，检查支付相关服务器：
- payment-web: 172.16.10.50
- payment-api: 172.16.10.51

验证：
1. 不必要端口是否关闭
2. Web服务安全配置
3. 管理界面访问控制
4. 符合性评估报告
```

### 渗透测试
```
模拟外部攻击者视角，扫描DMZ区域：
192.168.100.0/24

识别：
1. 可能的攻击面
2. 服务指纹信息
3. 潜在的安全弱点
4. 攻击路径分析
```

## 📊 报告格式

AI会自动生成包含以下内容的专业报告：

### 执行摘要
- 扫描范围和目标
- 发现的关键风险
- 优先级修复建议

### 技术细节
- 开放端口清单
- 服务版本信息
- Web技术栈分析
- 管理界面发现

### 风险评估
- 按CVSS评分的风险等级
- 业务影响分析
- 修复成本评估

### 修复建议
- 立即可执行的措施
- 短期改进计划
- 长期安全策略

现在您可以直接在Cursor中使用自然语言描述扫描需求，AI会智能地选择合适的MCP工具并提供专业的安全分析！ 